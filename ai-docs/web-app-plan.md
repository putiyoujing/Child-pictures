# 儿童识字小报Web应用生成方案

## 项目概述
使用HTML、CSS、JavaScript创建一个Web应用，集成儿童识字小报提示词模板和Nano Banana Pro API，实现图片生成功能。

## 核心功能
1. **提示词生成**：基于用户输入的主题和标题，自动生成详细的提示词
2. **API调用**：调用Nano Banana Pro API生成图片
3. **图片展示**：展示生成的图片并支持下载
4. **API密钥管理**：本地存储，保障安全

## 技术栈
- 前端：HTML + CSS + JavaScript（原生）
- 存储：localStorage（API密钥本地存储）
- API调用：fetch API + 轮询机制

## 项目结构
```
Child pictures/
├── index.html              # 主页面
├── css/
│   └── style.css          # 样式文件
├── js/
│   ├── app.js             # 主应用逻辑
│   ├── prompt-generator.js # 提示词生成器
│   ├── api-client.js      # API调用封装
│   └── word-bank.js       # 词汇库
└── images/                # 生成的图片展示目录
```

## 核心实现细节

### 1. 提示词生成 (prompt-generator.js)
- 内置词汇库系统，覆盖常见场景（超市、医院、公园、学校等）
- 每个主题包含15-20个相关词汇（带拼音）
- 动态填充模板，生成完整提示词
- 处理提示词长度限制
- 预制主题和标题库，支持快捷选择

### 1.1 预制主题分类系统
```javascript
const THEME_CATEGORIES = {
    // 生活场景类
    daily: {
        name: '生活场景',
        themes: {
            '超市': ['《走进超市》', '《快乐购物》', '《超市大探索》'],
            '家庭': ['《我的家》', '《温馨的家》', '《家人的爱》'],
            '学校': ['《美丽的校园》', '《上学路上》', '《课堂时光》'],
            '公园': ['《公园一角》', '《春天的公园》', '《快乐的公园》']
        }
    },
    // 社会场所类
    social: {
        name: '社会场所',
        themes: {
            '医院': ['《快乐医院》', '《医生阿姨》', '《看病不怕》'],
            '消防站': ['《英勇的消防员》', '《消防安全》', '《消防车来了》'],
            '警察局': ['《警察叔叔》', '《平安守护》', '《交通警察》'],
            '图书馆': ['《知识的海洋》', '《安静的图书馆》', '《读书真快乐》']
        }
    },
    // 自然动物类
    nature: {
        name: '自然动物',
        themes: {
            '动物园': ['《动物朋友》', '《动物园游记》', '《可爱的动物》'],
            '农场': ['《美丽的农场》', '《农场的一天》', '《丰收的喜悦》'],
            '海洋': ['《海底世界》', '《海洋生物》', '《奇妙的海底》'],
            '森林': ['《森林探险》', '《森林里的家》', '《保护森林》']
        }
    },
    // 交通工具类
    transport: {
        name: '交通工具',
        themes: {
            '汽车': ['《汽车总动员》', '《马路上的车》', '《交通安全》'],
            '火车': ['《火车之旅》', '《火车飞驰》', '《坐火车去旅行》'],
            '飞机': ['《蓝天飞翔》', '《飞机场》', '《坐飞机》'],
            '轮船': ['《海上航行》', '《大轮船》', '《港口风光》']
        }
    },
    // 节日文化类
    culture: {
        name: '节日文化',
        themes: {
            '春节': ['《过新年》', '《春节快乐》', '《红红火火过大年》'],
            '中秋节': ['《月亮圆圆》', '《中秋赏月》', '《团圆的节日》'],
            '端午节': ['《粽叶飘香》', '《赛龙舟》', '《端午节》'],
            '国庆节': ['《我爱祖国》', '《国庆快乐》', '《五星红旗》']
        }
    }
};
```

### 1.2 完整词汇库系统
```javascript
const WORD_BANK = {
    // 超市相关词汇（18个）
    '超市': {
        core: ['shōu yín yuán 收银员', 'huò jià 货架', 'tuī chē 推车', 'shòu huò yuán 售货员', 'jùn chē 购物车'],
        items: ['píng guǒ 苹果', 'niú nǎi 牛奶', 'miàn bāo 面包', 'yá gāo 牙膏', 'guǒ zhī 果汁', 'qiāo kè lì 巧克力', 'shuǐ guǒ 水果', 'shū cài 蔬菜'],
        env: ['chū kǒu 出口', 'rù kǒu 入口', 'dēng 灯', 'zhāo pái 招牌', 'jià gé qiā 价格卡']
    },

    // 医院相关词汇（18个）
    '医院': {
        core: ['yī shēng 医生', 'hù shi 护士', 'bìng chuáng 病床', 'bing rén 病人', 'yī yuàn 医院'],
        items: ['yào xiè 药箱', 'zhēn tou 针头', 'tǐ wēn jì 体温计', 'yī yī 听诊器', 'yào wù 药物', 'miàn zhēn 面罩', 'shǒu tào 手套', 'xiāo dú yè 消毒液'],
        env: ['guà hào chù 挂号处', 'děng dài qū 等待区', 'jǐ zhěn shì 急诊室', 'yào fang 药房', 'zhěn suǒ 诊所']
    },

    // 学校相关词汇（18个）
    '学校': {
        core: ['lǎo shī 老师', 'tóng xué 同学', 'jiào shì 教室', 'hēi bǎn 黑板', 'zhuō yǐ 桌椅'],
        items: ['shū bāo 书包', 'qiān bǐ 铅笔', 'zuò yè běn 作业本', 'wén jù hé 文具盒', 'shū 书', 'bǐ 笔', 'xiàng pí 橡皮', 'chǐ dào 尺子'],
        env: ['cāo chǎng 操场', 'tú shū guǎn 图书馆', 'shí táng 食堂', 'xiào mén 校门', 'jiào xué lóu 教学楼']
    },

    // 公园相关词汇（18个）
    '公园': {
        core: ['huā duǒ 花朵', 'shù mù 树木', 'cháng yǐ 长椅', 'huà tíng 画廊', 'xiǎo qiáo 小桥'],
        items: ['huā tán 花坛', 'qiū qiān 秋千', 'huá tǐ 滑梯', 'yǎo yáo chuán 摇摇船', 'diào chuán 吊船', 'niǔ niǔ chē 扭扭车', 'tī zi 梯子', 'pá pá gǒn 爬爬杆'],
        env: ['cǎo píng 草坪', 'xiǎo lù 小路', 'shí zǐ lù 石子路', 'shuǐ chí 水池', 'gōng gòng cè suǒ 公共厕所']
    },

    // ... 更多主题词汇
};
```

### 1.3 快捷选择界面功能
- 分类标签页（生活场景、社会场所、自然动物等）
- 主题选择卡片（带图标展示）
- 标题下拉选择框
- 支持自定义输入补充

### 2. API调用封装 (api-client.js)
```javascript
// API配置
const API_CONFIG = {
    createTask: 'https://api.kie.ai/api/v1/jobs/createTask',
    queryTask: 'https://api.kie.ai/api/v1/jobs/recordInfo',
    model: 'nano-banana-pro',
    aspectRatio: '2:3',  // 竖版A4比例
    resolution: '4K',    // 高清画质
    format: 'png'        // 图片格式
};
```

### 3. 用户界面设计 (index.html + style.css)
- **快捷选择区域**：
  - 顶部分类标签（生活场景、社会场所、自然动物、交通工具、节日文化）
  - 主题卡片网格布局（每个主题带图标和名称）
  - 标题下拉选择框（选择主题后自动加载对应标题）
  - 自定义输入选项（支持手动输入主题和标题）
- **API设置区域**：
  - API密钥输入框（带显示/隐藏切换）
  - 密钥本地存储状态显示
- **生成控制区域**：
  - 生成按钮（带加载状态）
  - 生成进度条和状态提示
- **结果展示区域**：
  - 生成的图片预览
  - 下载按钮
  - 历史记录列表
- **响应式设计**：适配PC和移动端

### 4. 安全措施
- API密钥使用localStorage存储
- 密钥输入支持隐藏/显示切换
- 提示用户妥善保管密钥

## API调用流程
1. 用户输入主题和标题 → 生成提示词
2. 检查API密钥 → 创建生成任务
3. 获取taskId → 开始轮询任务状态
4. 状态变为success → 获取图片URL
5. 展示图片 → 提供下载功能

## 词汇库示例 (word-bank.js)
```javascript
const WORD_BANK = {
    '超市': {
        core: ['shōu yín yuán 收银员', 'huò jià 货架', 'tuī chē 推车'],
        items: ['píng guǒ 苹果', 'niú nǎi 牛奶', 'miàn bāo 面包', 'yá gāo 牙膏'],
        env: ['chū kǒu 出口', 'rù kǒu 入口', 'dēng 灯', 'zhāo pái 招牌']
    },
    '医院': {
        core: ['yī shēng 医生', 'hù shi 护士', 'bìng chuáng 病床'],
        items: ['yào xiè 药箱', 'zhēn tou 针头', 'tǐ wēn jì 体温计'],
        env: ['guà hào chù 挂号处', 'děng dài qū 等待区', 'jǐ zhěn shì 急诊室']
    }
    // ... 更多主题
};
```

## 所需参考文件
- `f:\Project\Claude\Child pictures\ai-docs\prompt.md` - 提示词模板
- `f:\Project\Claude\Child pictures\ai-docs\api-nano-bana-pro.md` - API文档

## 实施优先级

### 第一阶段：基础框架
1. 创建HTML页面结构和基础样式
2. 实现分类标签和主题卡片UI
3. 添加API密钥输入和存储功能

### 第二阶段：核心功能
1. 实现主题和标题选择逻辑
2. 创建提示词生成器（整合词汇库）
3. 封装API调用功能
4. 实现任务状态轮询机制

### 第三阶段：用户体验
1. 添加生成进度显示
2. 实现图片预览和下载
3. 添加历史记录功能
4. 优化移动端适配

### 第四阶段：增强功能
1. 支持自定义主题和词汇扩展
2. 批量生成功能
3. 导出功能（PDF或图片集合）
4. 分享功能

## 注意事项
1. 提示词长度控制在10000字符以内
2. 轮询间隔建议3-5秒，避免频繁请求
3. 任务超时时间设置为5分钟
4. 图片URL可能有有效期，及时下载保存